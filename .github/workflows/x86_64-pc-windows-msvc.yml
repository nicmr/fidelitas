name: x86_64-pc-windows-msvc

on: [push]

jobs:
  build:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v1
         
#     - name: mkdir lib
#       run: mkdir lib
      
#     - name: Download libvlc for Windows
#       run: Invoke-WebRequest "download.videolan.org/pub/videolan/vlc/3.0.8/win64/vlc-3.0.8-win64.7z" -OutFile vlc-3.0.8-win64.7z
    
#     - name: Extract libvlc for Windows
#       run: 7z.exe e .\vlc-3.0.8-win64.7z vlc-3.0.8\sdk\lib -o".\lib"
      
#     - name: Rename vlc lib files (vlc.lib is not actually binary by default)
#       run: |
#         mv .\lib\vlc.lib vlc.lib.renamed
#         mv .\lib\vlccore.lib vlccore.lib.renamed
#         mv .\lib\libvlc.lib vlc.lib
#         mv .\lib\libvlccore.lib vlccore.lib

    - name: Install libvlc using NuGet / Install-Package
      run: Install-Package VideoLAN.LibVLC.Windows -Version 3.0.8.1
        
    - name: Build
      run: cargo build --verbose
#       env :
#         RUSTFLAGS: "-L ./lib"
#         LIB: "$env:LIB;\\a\\fidelitas\\fidelitas\\lib;"
      
    - name: Run tests
      run: cargo test --verbose
